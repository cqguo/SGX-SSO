\section{Threat Model and Assumptions}
XXX is compatible with OIDC, consisted of a number of RPs, user agents(i.e., the browser and enclave application) and an IdP. In this section, we describe the threat model and assumptions of these entities in XXX.
\subsection{Threat Model}
\noindent\textbf{Adversaries' Goals: } (1) The adversaries can impersonate an honest user to log in to the honest RP. (2) The adversary lead the honest user to send the malicious identity proof (generated by the adversary) to the honest RP. 

\noindent\textbf{Adversaries' Capacities: }
\begin{itemize}
\item An adversary can act as the malicious user. The adversary can control all the software running outside the enclave, for example, capturing and tempering the message transmission among enclave application, browser and IdP server, decrypting and tempering the https flow outside the enclave, tempering the script code running on the browser.
\item An adversary can act as the malicious RP. The adversary can lead the user to log in to the malicious RP. In this situation, the adversary can manipulate or all the message transmitted through RP, and collect all the flows received from user to link the user identity.
\item An adversary can act as the curious but honest IdP. The curious IdP can store and analyze the received messages, and perform the timing attacks, attempting to achieve the IdP-based linkage. However, the honest IdP must process the requests of RP registration and identity proof correctly, and never colludes with others (e.g., malicious RPs and users).
\end{itemize}

\subsection{Assumptions}
We assume the honest user's device is secure, for example, the user would not install any malicious application on her device. The application and data inside the enclave are never tempered or leaked, even in the malicious user's device.

The TLS is also adopted and correctly implemented at the system, so that the communications among entities ensure the confidentiality and integrity.
The cryptographic algorithms and building blocks used in XXX are assumed to be secure and correctly implemented. 

Phishing attack is not considered in this paper.

